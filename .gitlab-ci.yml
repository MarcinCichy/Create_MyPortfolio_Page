image: python:3.10

stages:
  - build

pages:
  stage: build
  script:
    # 1. Instalacja zależności
    - pip install -r requirements.txt

    # 2. Generowanie plików HTML
    - python generate_portfolio.py

    # 3. Tworzenie folderu public i kopiowanie wszystkich plików
    - mkdir public
    - cp -r *.html public/
    - cp -r static/ public/static/
    - "curl -X POST --fail -F token=${CI_JOB_TOKEN} -F ref=main https://gitlab.com/api/v4/projects/66394676/trigger/pipeline"

  artifacts:
    paths:
      - public
    expire_in: 1 week

  only:
    - main  # pipeline ruszy tylko przy pushu na main

